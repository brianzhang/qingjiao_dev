!function(t){var e=function(e,n){this.self=e,this.$element=t(e),this.onItem=n.onItem||this.onItem,this.listen()}
e.prototype={init:function(e){this.$menu=this.getMenu(),t(".bootstrap-contextmenu").hide(),this.show(e),t("html").on("click.context.data-api",this.$menu.selector,t.proxy(this.closemenu,this)),e.stopPropagation()},show:function(e){var n,o,i="li:not(.divider)",s=this.getMenu(),r={relatedTarget:this.self,target:e.currentTarget}
this.closemenu(e),s.trigger(o=t.Event("show.bs.context",r)),n=this.getPosition(e,s),s.attr("style","").css(n).addClass("open").on("click.context.data-api",i,t.proxy(this.onItem,this,t(e.currentTarget))).trigger("shown.bs.context",r)},getMenu:function(){return this.$element},closemenu:function(e){var n,o,i,s
n=this.getMenu(),n&&n.hasClass("open")&&(s={relatedTarget:this},n.trigger(o=t.Event("hide.bs.context",s)),i="li:not(.divider)",n.removeClass("open").attr("style","").off("click.context.data-api",i).trigger("hidden.bs.context",s),t("html").off("click.context.data-api",n.selector),e.stopPropagation())},getPosition:function(e,n){if(0==n.length)return{}
var o,i,s,r=e.clientX,c=e.clientY,h=t(window).width(),l=t(window).height(),a=n.find(".dropdown-menu"),d=a.outerWidth(),u=a.outerHeight(),f={position:"absolute","z-index":9999}
if(0>=u){var p=a.children("li").length,g=a.find("a").length,w=0
p>g&&(w=3*(p-g)),u=35*g+w}return o=c+u>l?{top:c-u+t(window).scrollTop()}:{top:c+t(window).scrollTop()},i=r+d>h&&r-d>0?{left:r-d+t(window).scrollLeft()}:{left:r+t(window).scrollLeft()},s=n.offsetParent().offset(),i.left=i.left-s.left,o.top=o.top-s.top,t.extend(f,o,i)},onItem:function(t){return!0},keydown:function(t){27==t.which&&this.closemenu(t)},listen:function(){this.$element.on("contextmenu.context.data-api",this.scopes,t.proxy(this.show,this)),t("html").on("click.context.data-api",t.proxy(this.closemenu,this)),t("html").on("keydown.context.data-api",t.proxy(this.keydown,this))}},t.fn.contextMenu=function(t,n){var o=new e(this,n)
return o.init(t),o}}(jQuery)
